<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MealPrep Buddy</title>
  <meta name="description" content="–¢–∏–∂–Ω–µ–≤–∏–π –ø–ª–∞–Ω —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è —Ç–∞ —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫." />

  <style>
    :root{
      --bg:#0b1020;
      --text:#e9ecf5;
      --muted:#b7c0dd;
      --accent:#7c5cff;
      --line:rgba(255,255,255,.12);
      --shadow: 0 18px 50px rgba(0,0,0,.35);
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(1100px 600px at 20% 10%, rgba(124,92,255,.25), transparent 55%),
        radial-gradient(900px 500px at 80% 15%, rgba(124,92,255,.12), transparent 55%),
        var(--bg);
      color:var(--text);
      line-height:1.5;
    }
    a{color:inherit}
    .container{max-width:1100px;margin:0 auto;padding:0 18px}
    .muted{color:var(--muted)}

    header{
      position:sticky;top:0;z-index:50;
      backdrop-filter: blur(12px);
      background: rgba(11,16,32,.7);
      border-bottom:1px solid var(--line);
    }
    .header-row{
      display:flex;align-items:center;justify-content:space-between;gap:16px;
      padding:14px 0;
    }
    .brand{display:flex;align-items:center;gap:10px;text-decoration:none}
    .brand-mark{font-size:22px}
    .brand-text{font-weight:700;letter-spacing:.2px}
    .nav{
      display:flex;align-items:center;gap:14px;flex-wrap:wrap;
    }
    .nav a{
      text-decoration:none;
      padding:8px 10px;border-radius:10px;
      color:var(--muted);
    }
    .nav a:hover{background:rgba(255,255,255,.06);color:var(--text)}

    section{padding:46px 0}
    .section-head{
      display:flex;align-items:flex-end;justify-content:space-between;gap:18px;flex-wrap:wrap;
      margin-bottom:18px;
    }
    h1,h2,h3{margin:0 0 10px}
    h1{font-size: clamp(28px, 3vw, 40px);line-height:1.12}
    h2{font-size: clamp(22px, 2.2vw, 28px)}
    h3{font-size: 18px}

    .btn{
      appearance:none;border:0;cursor:pointer;
      padding:10px 14px;border-radius:12px;
      font-weight:600;
      display:inline-flex;align-items:center;justify-content:center;gap:8px;
      transition: transform .05s ease, background .15s ease, border-color .15s ease;
      text-decoration:none;
    }
    .btn:active{transform: translateY(1px)}
    .btn-primary{
      background: linear-gradient(135deg, var(--accent), rgba(124,92,255,.65));
      color:white;
      box-shadow: 0 14px 30px rgba(124,92,255,.25);
    }
    .btn-secondary{
      background: rgba(255,255,255,.06);
      border:1px solid var(--line);
      color:var(--text);
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:16px;
    }

    .hero{padding-top:32px}
    .hero-grid{
      display:grid;
      grid-template-columns: 1.1fr 0.9fr;
      gap:26px;
      align-items:center;
    }
    .hero-actions{display:flex;gap:12px;flex-wrap:wrap;margin-top:14px}
    .hero-bullets{margin:14px 0 0;padding:0;list-style:none;display:grid;gap:8px}
    .hero-bullets li{color:var(--muted)}
    .hero-image img{
      width:100%;
      height:420px;
      object-fit:cover;
      border-radius: var(--radius);
      border:1px solid var(--line);
      box-shadow: var(--shadow);
      display:block;
    }
    @media (max-width: 900px){
      .hero-grid{grid-template-columns:1fr}
      .hero-image img{height:260px}
    }

    .grid-2{display:grid;grid-template-columns: 1fr 1fr;gap:16px}
    @media (max-width: 900px){.grid-2{grid-template-columns:1fr}}

    .planner-grid{display:grid;gap:12px}
    .planner-row{
      display:grid;
      grid-template-columns: 90px 1fr 1fr;
      gap:10px;align-items:center;
      padding:10px 12px;border:1px solid var(--line);border-radius:14px;
      background: rgba(0,0,0,.12);
    }
    .day{font-weight:700}
    select{
      width:100%;
      padding:10px 10px;border-radius:12px;border:1px solid var(--line);
      background: rgba(255,255,255,.04);color:var(--text);outline:none;
    }
    option{color:#0b1020}

    .checklist{display:grid;gap:10px;margin-top:10px;}
    .item{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      padding:10px 12px;border:1px solid var(--line);border-radius:14px;
      background: rgba(0,0,0,.12);
    }
    .item label{display:flex;align-items:center;gap:10px;cursor:pointer}
    .item input{transform: scale(1.15)}
    .tag{
      font-size:12px;color:var(--muted);
      border:1px solid var(--line);padding:3px 8px;border-radius:999px;
      background: rgba(255,255,255,.04);white-space:nowrap;
    }
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .small{font-size:13px}

    footer{
      padding:22px 0;
      border-top:1px solid var(--line);
      color:var(--muted);
    }
    .footer-row{display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap}
  </style>
</head>

<body>
  <header id="top">
    <div class="container header-row">
      <a class="brand" href="#top" aria-label="–ù–∞ –ø–æ—á–∞—Ç–æ–∫ —Å—Ç–æ—Ä—ñ–Ω–∫–∏">
        <span class="brand-mark">üç≤</span>
        <span class="brand-text">MealPrep Buddy</span>
      </a>

      <nav class="nav" aria-label="–û—Å–Ω–æ–≤–Ω–∞ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è">
        <a href="#about">–ü—Ä–æ –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫</a>
        <a href="#planner">–ü–ª–∞–Ω —Ç–∏–∂–Ω—è</a>
        <a href="#shopping">–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫</a>
        <a href="#contact">–ö–æ–Ω—Ç–∞–∫—Ç–∏</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="container hero-grid">
        <div class="hero-text">
          <h1>–ü–ª–∞–Ω—É–π —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å ‚Äî —à–≤–∏–¥–∫–æ —ñ –±–µ–∑ —Å—Ç—Ä–µ—Å—É</h1>
          <p class="muted">
            –û–±–µ—Ä–∏ —Å—Ç—Ä–∞–≤–∏ –Ω–∞ –∫–æ–∂–µ–Ω –¥–µ–Ω—å. –°–∏—Å—Ç–µ–º–∞ –∑–≥–µ–Ω–µ—Ä—É—î —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏ –Ω–∞ –≤–µ—Å—å —Ç–∏–∂–¥–µ–Ω—å.
            –í—ñ–¥–º—ñ—á–∞–π, —â–æ –≤–∂–µ —î –≤–¥–æ–º–∞ ‚Äî —Ä–µ—à—Ç–∞ —Å—Ñ–æ—Ä–º—É—î—Ç—å—Å—è —É —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ —ñ –ø—ñ–¥–≥–æ—Ç—É—î—Ç—å—Å—è –¥–æ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –Ω–∞ email.
          </p>

          <div class="hero-actions">
            <a class="btn btn-primary" href="#planner">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –ø–ª–∞–Ω—É</a>
            <a class="btn btn-secondary" href="#shopping">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Å–ø–∏—Å–æ–∫</a>
          </div>

          <ul class="hero-bullets">
            <li>‚úÖ 7 –¥–Ω—ñ–≤ (–æ–±—ñ–¥ + –≤–µ—á–µ—Ä—è)</li>
            <li>‚úÖ –Ü–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏ –Ω–∞ —Ü—ñ–ª–∏–π —Ç–∏–∂–¥–µ–Ω—å</li>
            <li>‚úÖ –°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ –∑ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º</li>
          </ul>
        </div>

        <div class="hero-image">
          <img src="images/mealprep-hero.jpg" alt="–ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å" />
        </div>
      </div>
    </section>

    <section id="about">
      <div class="container">
        <div class="section-head">
          <div>
            <h2>–ü—Ä–æ –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫</h2>
            <p class="muted">
              –û–¥–∏–Ω –ø–ª–∞–Ω –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å ‚Äî –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç—ñ–≤. –í—ñ–¥–º—ñ—á–∞–π, —â–æ –≤–∂–µ —î, —ñ –æ—Ç—Ä–∏–º—É–π —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ –±–µ–∑ –∑–∞–π–≤–∏—Ö –¥—É–±–ª—é–≤–∞–Ω—å.
            </p>
          </div>
        </div>

        <div class="grid-2">
          <article class="card">
            <h3>–Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î</h3>
            <ol class="muted" style="margin:8px 0 0;padding-left:18px">
              <li>–û–±–∏—Ä–∞—î—à —Å—Ç—Ä–∞–≤–∏ –Ω–∞ –∫–æ–∂–µ–Ω –¥–µ–Ω—å</li>
              <li>–û—Ç—Ä–∏–º—É—î—à —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏ –Ω–∞ –≤–µ—Å—å —Ç–∏–∂–¥–µ–Ω—å</li>
              <li>–í—ñ–¥–º—ñ—á–∞—î—à, —â–æ –≤–∂–µ —î –≤–¥–æ–º–∞</li>
              <li>–ù–∞–¥—Å–∏–ª–∞—î—à —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ –Ω–∞ email</li>
            </ol>
          </article>

          <article class="card">
            <h3>–ü–µ—Ä–µ–≤–∞–≥–∏</h3>
            <ul class="muted" style="margin:8px 0 0;padding-left:18px">
              <li>–º–µ–Ω—à–µ —á–∞—Å—É –Ω–∞ –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è</li>
              <li>–º–µ–Ω—à–µ –∑–∞–±—É—Ç–∏—Ö –ø—Ä–æ–¥—É–∫—Ç—ñ–≤</li>
              <li>–∑—Ä–æ–∑—É–º—ñ–ª–∏–π —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫</li>
            </ul>
          </article>
        </div>
      </div>
    </section>

    <section id="planner">
      <div class="container">
        <div class="section-head">
          <div>
            <h2>–ü–ª–∞–Ω —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å</h2>
            <p class="muted">–û–±–µ—Ä–∏ —Å—Ç—Ä–∞–≤–∏ ‚Äî —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏ —Ç–∞ —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ –æ–Ω–æ–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.</p>
          </div>
          <button class="btn btn-primary" id="buildBtn" type="button">–û–Ω–æ–≤–∏—Ç–∏</button>
        </div>

        <div class="card">
          <div class="planner-grid" id="plannerGrid" aria-label="–ü–ª–∞–Ω–µ—Ä —Ç–∏–∂–Ω—è"></div>
        </div>
      </div>
    </section>

    <section id="shopping">
      <div class="container">
        <div class="section-head">
          <div>
            <h2>–Ü–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏ –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å —Ç–∞ —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫</h2>
            <p class="muted">–í—ñ–¥–º—ñ—á–∞–π ¬´–≤–∂–µ —î¬ª ‚Äî —É —Å–ø–∏—Å–∫—É –ø–æ–∫—É–ø–æ–∫ –∑–∞–ª–∏—à–∏—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ —Ç–µ, —â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∫—É–ø–∏—Ç–∏.</p>
          </div>
        </div>

        <div class="grid-2">
          <div class="card">
            <h3>–Ü–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏</h3>
            <div id="weeklyIngredients" class="checklist" aria-label="–Ü–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏ –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å"></div>

            <div class="actions">
              <button class="btn btn-secondary" id="markAllHaveBtn" type="button">–í–∂–µ —î –≤—Å–µ</button>
              <button class="btn btn-secondary" id="clearHaveBtn" type="button">–°–∫–∏–Ω—É—Ç–∏</button>
            </div>
          </div>

          <aside class="card">
            <h3>–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫</h3>
            <div id="shoppingList" class="checklist" aria-label="–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫"></div>

            <div class="actions">
              <button class="btn btn-primary" id="emailBtn" type="button">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –Ω–∞ email</button>
            </div>
          </aside>
        </div>
      </div>
    </section>

    <section id="contact">
      <div class="container">
        <div class="section-head">
          <div>
            <h2>–ö–æ–Ω—Ç–∞–∫—Ç–∏</h2>
            <p class="muted">–ù–∞–ø–∏—à–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.</p>
          </div>
          <a class="btn btn-secondary" href="#top">‚Üë –ù–∞ –ø–æ—á–∞—Ç–æ–∫</a>
        </div>

        <div class="grid-2">
          <form class="card" action="#" method="post">
            <div style="display:grid;gap:10px">
              <div>
                <label for="name" class="muted small">–Ü–º º—è</label>
                <input id="name" name="name" type="text" required placeholder="–í–∞—à–µ —ñ–º º—è"
                       style="width:100%;margin-top:6px;padding:10px 10px;border-radius:12px;border:1px solid var(--line);background:rgba(255,255,255,.04);color:var(--text)" />
              </div>

              <div>
                <label for="email" class="muted small">Email</label>
                <input id="email" name="email" type="email" required placeholder="name@example.com"
                       style="width:100%;margin-top:6px;padding:10px 10px;border-radius:12px;border:1px solid var(--line);background:rgba(255,255,255,.04);color:var(--text)" />
              </div>

              <div>
                <label for="msg" class="muted small">–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</label>
                <textarea id="msg" name="msg" rows="5" placeholder="–¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è..."
                          style="width:100%;margin-top:6px;padding:10px 10px;border-radius:12px;border:1px solid var(--line);background:rgba(255,255,255,.04);color:var(--text)"></textarea>
              </div>

              <button class="btn btn-primary" type="submit">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
            </div>
          </form>

        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container footer-row">
      <span>¬© 2025 MealPrep Buddy</span>
    </div>
  </footer>

  <script>
    const MEALS = {
      "–°–∞–ª–∞—Ç –∑ —Ç—É–Ω—Ü–µ–º": ["–¢—É–Ω–µ—Ü—å (–∫–æ–Ω—Å–µ—Ä–≤–∞)", "–õ–∏—Å—Ç—è —Å–∞–ª–∞—Ç—É", "–û–≥—ñ—Ä–æ–∫", "–ü–æ–º—ñ–¥–æ—Ä–∏", "–û–ª–∏–≤–∫–æ–≤–∞ –æ–ª—ñ—è"],
      "–ü–∞—Å—Ç–∞ –∑ –æ–≤–æ—á–∞–º–∏": ["–ü–∞—Å—Ç–∞", "–ë–æ–ª–≥–∞—Ä—Å—å–∫–∏–π –ø–µ—Ä–µ—Ü—å", "–¶–∏–±—É–ª—è", "–ß–∞—Å–Ω–∏–∫", "–¢–æ–º–∞—Ç–Ω–∏–π —Å–æ—É—Å"],
      "–ì—Ä–µ—á–∫–∞ + –∫—É—Ä–∫–∞": ["–ì—Ä–µ—á–∫–∞", "–ö—É—Ä—è—á–µ —Ñ—ñ–ª–µ", "–°–ø–µ—Ü—ñ—ó"],
      "–û–≤–æ—á–µ–≤–∏–π —Å—É–ø": ["–ö–∞—Ä—Ç–æ–ø–ª—è", "–ú–æ—Ä–∫–≤–∞", "–¶–∏–±—É–ª—è", "–õ–∞–≤—Ä–æ–≤–∏–π –ª–∏—Å—Ç"],
      "–û–º–ª–µ—Ç –∑ —Å–∏—Ä–æ–º": ["–Ø–π—Ü—è", "–¢–≤–µ—Ä–¥–∏–π —Å–∏—Ä", "–ó–µ–ª–µ–Ω—å"],
      "–ó–∞–ø–µ—á–µ–Ω–∞ —Ä–∏–±–∞": ["–†–∏–±–∞", "–õ–∏–º–æ–Ω", "–°—ñ–ª—å", "–ü–µ—Ä–µ—Ü—å"],
      "–ß–∏–ª—ñ –∑ –∫–≤–∞—Å–æ–ª–µ—é": ["–ö–≤–∞—Å–æ–ª—è", "–¢–æ–º–∞—Ç–Ω–∏–π —Å–æ—É—Å", "–¶–∏–±—É–ª—è", "–°–ø–µ—Ü—ñ—ó"],
      "–°–∏—Ä–Ω–∏–∫–∏": ["–¢–≤–æ—Ä–æ–≥", "–Ø–π—Ü—è", "–ë–æ—Ä–æ—à–Ω–æ", "–¶—É–∫–æ—Ä"],
      "–°–º—É–∑—ñ –±–æ—É–ª": ["–ë–∞–Ω–∞–Ω", "–Ø–≥–æ–¥–∏", "–ô–æ–≥—É—Ä—Ç", "–í—ñ–≤—Å—è–Ω–∫–∞"],
      "–†–∏—Å –∑ –æ–≤–æ—á–∞–º–∏": ["–†–∏—Å", "–û–≤–æ—á–µ–≤–∞ —Å—É–º—ñ—à", "–°–æ—î–≤–∏–π —Å–æ—É—Å (–æ–ø—Ü.)"],
      "–ö—É—Å–∫—É—Å + –æ–≤–æ—á—ñ": ["–ö—É—Å–∫—É—Å", "–û–≤–æ—á–µ–≤–∞ —Å—É–º—ñ—à", "–û–ª–∏–≤–∫–æ–≤–∞ –æ–ª—ñ—è"],
      "–ô–æ–≥—É—Ä—Ç + —Ñ—Ä—É–∫—Ç–∏": ["–ô–æ–≥—É—Ä—Ç", "–§—Ä—É–∫—Ç–∏"]
    };

    const DAYS = [
      { key: "mon", label: "–ü–Ω" },
      { key: "tue", label: "–í—Ç" },
      { key: "wed", label: "–°—Ä" },
      { key: "thu", label: "–ß—Ç" },
      { key: "fri", label: "–ü—Ç" },
      { key: "sat", label: "–°–±" },
      { key: "sun", label: "–ù–¥" },
    ];

    const defaultPlan = {
      mon: { lunch: "–°–∞–ª–∞—Ç –∑ —Ç—É–Ω—Ü–µ–º", dinner: "–ü–∞—Å—Ç–∞ –∑ –æ–≤–æ—á–∞–º–∏" },
      tue: { lunch: "–ì—Ä–µ—á–∫–∞ + –∫—É—Ä–∫–∞", dinner: "–û–≤–æ—á–µ–≤–∏–π —Å—É–ø" },
      wed: { lunch: "–û–º–ª–µ—Ç –∑ —Å–∏—Ä–æ–º", dinner: "–†–∏—Å –∑ –æ–≤–æ—á–∞–º–∏" },
      thu: { lunch: "–ô–æ–≥—É—Ä—Ç + —Ñ—Ä—É–∫—Ç–∏", dinner: "–ó–∞–ø–µ—á–µ–Ω–∞ —Ä–∏–±–∞" },
      fri: { lunch: "–°–∞–ª–∞—Ç –∑ —Ç—É–Ω—Ü–µ–º", dinner: "–ß–∏–ª—ñ –∑ –∫–≤–∞—Å–æ–ª–µ—é" },
      sat: { lunch: "–°–∏—Ä–Ω–∏–∫–∏", dinner: "–ö—É—Å–∫—É—Å + –æ–≤–æ—á—ñ" },
      sun: { lunch: "–°–º—É–∑—ñ –±–æ—É–ª", dinner: "–ü–∞—Å—Ç–∞ –∑ –æ–≤–æ—á–∞–º–∏" }
    };

    const LS = { plan: "mpb_plan_clean", have: "mpb_have_clean" };

    function loadPlan(){
      try{ return JSON.parse(localStorage.getItem(LS.plan)) || defaultPlan; }
      catch{ return defaultPlan; }
    }
    function savePlan(plan){ localStorage.setItem(LS.plan, JSON.stringify(plan)); }

    function loadHave(){
      try{ return JSON.parse(localStorage.getItem(LS.have)) || {}; }
      catch{ return {}; }
    }
    function saveHave(have){ localStorage.setItem(LS.have, JSON.stringify(have)); }

    function normalizeKey(s){
      return s.toLowerCase().replace(/\s+/g, "_").replace(/[^\w–∞-—è—ñ—ó—î“ë_-]/gi, "");
    }

    function mealOptionsHTML(selected){
      const opts = Object.keys(MEALS)
        .sort((a,b)=>a.localeCompare(b,"uk"))
        .map(name => `<option value="${name}" ${name===selected ? "selected" : ""}>${name}</option>`)
        .join("");
      return `<option value="">‚Äî –æ–±—Ä–∞—Ç–∏ ‚Äî</option>${opts}`;
    }

    function renderPlanner(){
      const grid = document.getElementById("plannerGrid");
      const plan = loadPlan();
      grid.innerHTML = "";

      DAYS.forEach(d => {
        const row = document.createElement("div");
        row.className = "planner-row";
        row.innerHTML = `
          <div class="day">${d.label}</div>
          <div>
            <div class="muted small" style="margin-bottom:6px">–û–±—ñ–¥</div>
            <select data-day="${d.key}" data-slot="lunch" aria-label="–û–±—ñ–¥ ${d.label}">
              ${mealOptionsHTML(plan[d.key]?.lunch || "")}
            </select>
          </div>
          <div>
            <div class="muted small" style="margin-bottom:6px">–í–µ—á–µ—Ä—è</div>
            <select data-day="${d.key}" data-slot="dinner" aria-label="–í–µ—á–µ—Ä—è ${d.label}">
              ${mealOptionsHTML(plan[d.key]?.dinner || "")}
            </select>
          </div>
        `;
        grid.appendChild(row);
      });

      grid.querySelectorAll("select").forEach(sel => {
        sel.addEventListener("change", () => {
          const day = sel.getAttribute("data-day");
          const slot = sel.getAttribute("data-slot");
          const value = sel.value;

          const current = loadPlan();
          current[day] = current[day] || { lunch:"", dinner:"" };
          current[day][slot] = value;
          savePlan(current);

          buildWeeklyIngredients();
        });
      });
    }

    function getMealsFromPlan(plan){
      const selected = [];
      DAYS.forEach(d => {
        const day = plan[d.key] || {};
        if (day.lunch) selected.push(day.lunch);
        if (day.dinner) selected.push(day.dinner);
      });
      return selected;
    }

    function computeWeeklyIngredients(){
      const plan = loadPlan();
      const selectedMeals = getMealsFromPlan(plan);

      const map = new Map();
      selectedMeals.forEach(meal => {
        const ings = MEALS[meal];
        if (!ings) return;
        ings.forEach(ing => {
          if (!map.has(ing)) map.set(ing, { count: 1, key: normalizeKey(ing) });
          else map.get(ing).count += 1;
        });
      });

      return Array.from(map.entries())
        .map(([name, meta]) => ({ name, count: meta.count, key: meta.key }))
        .sort((a,b)=>a.name.localeCompare(b.name,"uk"));
    }

    function buildWeeklyIngredients(){
      const weekly = computeWeeklyIngredients();
      const have = loadHave();

      const weeklyEl = document.getElementById("weeklyIngredients");
      weeklyEl.innerHTML = "";

      weekly.forEach(item => {
        const checked = !!have[item.key];
        const row = document.createElement("div");
        row.className = "item";
        row.innerHTML = `
          <label>
            <input type="checkbox" data-key="${item.key}" ${checked ? "checked" : ""}>
            <span>${item.name}</span>
          </label>
          <span class="tag">√ó${item.count}</span>
        `;
        row.querySelector("input").addEventListener("change", (e) => {
          const k = e.target.getAttribute("data-key");
          const updated = loadHave();
          updated[k] = e.target.checked;
          saveHave(updated);
          renderShoppingList();
        });
        weeklyEl.appendChild(row);
      });

      renderShoppingList();
    }

    function renderShoppingList(){
      const weekly = computeWeeklyIngredients();
      const have = loadHave();
      const shopping = weekly.filter(x => !have[x.key]);

      const shoppingEl = document.getElementById("shoppingList");
      shoppingEl.innerHTML = "";

      if (shopping.length === 0){
        shoppingEl.innerHTML = `<div class="muted">–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π.</div>`;
        return;
      }

      shopping.forEach(item => {
        const row = document.createElement("div");
        row.className = "item";
        row.innerHTML = `
          <div style="display:flex;align-items:center;gap:10px">
            <span>üõí</span>
            <span>${item.name}</span>
          </div>
          <span class="tag">√ó${item.count}</span>
        `;
        shoppingEl.appendChild(row);
      });
    }

    function buildEmailText(){
      const plan = loadPlan();
      const weekly = computeWeeklyIngredients();
      const have = loadHave();
      const toBuy = weekly.filter(x => !have[x.key]);

      const planLines = DAYS.map(d => {
        const day = plan[d.key] || {};
        const l = day.lunch || "‚Äî";
        const dn = day.dinner || "‚Äî";
        return `${d.label}: –û–±—ñ–¥ ‚Äî ${l}; –í–µ—á–µ—Ä—è ‚Äî ${dn}`;
      });

      const buyLines = toBuy.length
        ? toBuy.map(x => `- ${x.name} (√ó${x.count})`).join("\n")
        : "(–ù–µ–º–∞—î –ø–æ–∑–∏—Ü—ñ–π)";

      return `–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫\n\n–ü–ª–∞–Ω –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å:\n${planLines.join("\n")}\n\n–ö—É–ø–∏—Ç–∏:\n${buyLines}\n`;
    }

    document.getElementById("buildBtn").addEventListener("click", () => {
      buildWeeklyIngredients();
      document.getElementById("shopping").scrollIntoView({ behavior: "smooth" });
    });

    document.getElementById("clearHaveBtn").addEventListener("click", () => {
      localStorage.removeItem(LS.have);
      buildWeeklyIngredients();
    });

    document.getElementById("markAllHaveBtn").addEventListener("click", () => {
      const weekly = computeWeeklyIngredients();
      const have = {};
      weekly.forEach(x => { have[x.key] = true; });
      saveHave(have);
      buildWeeklyIngredients();
    });

    document.getElementById("emailBtn").addEventListener("click", () => {
      const subject = encodeURIComponent("–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫");
      const body = encodeURIComponent(buildEmailText());
      window.location.href = `mailto:?subject=${subject}&body=${body}`;
    });

    renderPlanner();
    buildWeeklyIngredients();
  </script>
</body>
</html>
