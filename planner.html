<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MealPrep Buddy ‚Äî Planner</title>
  <meta name="description" content="–ü–ª–∞–Ω —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å." />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="site-header" id="top">
    <div class="container header-row">
      <a class="brand" href="hero.html" aria-label="–ù–∞ –≥–æ–ª–æ–≤–Ω—É">
        <span class="brand-mark">üç≤</span>
        <span class="brand-text">MealPrep Buddy</span>
      </a>

      <!-- ‚úÖ Added explicit Hero link -->
      <nav class="nav" aria-label="–ù–∞–≤—ñ–≥–∞—Ü—ñ—è">
        <a href="hero.html">Hero</a>
        <a href="planner.html" aria-current="page">–ü–ª–∞–Ω —Ç–∏–∂–Ω—è</a>
        <a href="shopping.html">–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="section" id="planner">
      <div class="container">
        <div class="section-head">
          <div>
            <h2>–ü–ª–∞–Ω —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å</h2>
            <p class="muted">–ó–º—ñ–Ω–∏ —Å—Ç—Ä–∞–≤–∏ ‚Äî —Å–ø–∏—Å–æ–∫ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç—ñ–≤ —ñ –ø–æ–∫—É–ø–æ–∫ –æ–Ω–æ–≤–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.</p>
          </div>
          <button class="btn" id="buildBtn" type="button">–î–æ —Å–ø–∏—Å–∫—É –ø–æ–∫—É–ø–æ–∫</button>
        </div>

        <div class="card">
          <div class="planner-grid" id="plannerGrid" aria-label="–ü–ª–∞–Ω–µ—Ä —Ç–∏–∂–Ω—è"></div>
        </div>

        <div class="actions" style="margin-top:16px;">
          <a class="btn" href="shopping.html">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ —Å–ø–∏—Å–∫—É –ø–æ–∫—É–ø–æ–∫</a>
        </div>
      </div>
    </section>
  </main>

  <script>
    // --- Shared app logic (guarded so it works across separate pages) ---
    const MEALS = {
      "–°–∞–ª–∞—Ç –∑ —Ç—É–Ω—Ü–µ–º": ["–¢—É–Ω–µ—Ü—å (–∫–æ–Ω—Å–µ—Ä–≤–∞)", "–õ–∏—Å—Ç—è —Å–∞–ª–∞—Ç—É", "–û–≥—ñ—Ä–æ–∫", "–ü–æ–º—ñ–¥–æ—Ä–∏", "–û–ª–∏–≤–∫–æ–≤–∞ –æ–ª—ñ—è"],
      "–ü–∞—Å—Ç–∞ –∑ –æ–≤–æ—á–∞–º–∏": ["–ü–∞—Å—Ç–∞", "–ë–æ–ª–≥–∞—Ä—Å—å–∫–∏–π –ø–µ—Ä–µ—Ü—å", "–¶–∏–±—É–ª—è", "–ß–∞—Å–Ω–∏–∫", "–¢–æ–º–∞—Ç–Ω–∏–π —Å–æ—É—Å"],
      "–ì—Ä–µ—á–∫–∞ + –∫—É—Ä–∫–∞": ["–ì—Ä–µ—á–∫–∞", "–ö—É—Ä—è—á–µ —Ñ—ñ–ª–µ", "–°–ø–µ—Ü—ñ—ó"],
      "–û–≤–æ—á–µ–≤–∏–π —Å—É–ø": ["–ö–∞—Ä—Ç–æ–ø–ª—è", "–ú–æ—Ä–∫–≤–∞", "–¶–∏–±—É–ª—è", "–õ–∞–≤—Ä–æ–≤–∏–π –ª–∏—Å—Ç"],
      "–û–º–ª–µ—Ç –∑ —Å–∏—Ä–æ–º": ["–Ø–π—Ü—è", "–¢–≤–µ—Ä–¥–∏–π —Å–∏—Ä", "–ó–µ–ª–µ–Ω—å"],
      "–ó–∞–ø–µ—á–µ–Ω–∞ —Ä–∏–±–∞": ["–†–∏–±–∞", "–õ–∏–º–æ–Ω", "–°—ñ–ª—å", "–ü–µ—Ä–µ—Ü—å"],
      "–ß–∏–ª—ñ –∑ –∫–≤–∞—Å–æ–ª–µ—é": ["–ö–≤–∞—Å–æ–ª—è", "–¢–æ–º–∞—Ç–Ω–∏–π —Å–æ—É—Å", "–¶–∏–±—É–ª—è", "–°–ø–µ—Ü—ñ—ó"],
      "–°–∏—Ä–Ω–∏–∫–∏": ["–¢–≤–æ—Ä–æ–≥", "–Ø–π—Ü—è", "–ë–æ—Ä–æ—à–Ω–æ", "–¶—É–∫–æ—Ä"],
      "–°–º—É–∑—ñ –±–æ—É–ª": ["–ë–∞–Ω–∞–Ω", "–Ø–≥–æ–¥–∏", "–ô–æ–≥—É—Ä—Ç", "–í—ñ–≤—Å—è–Ω–∫–∞"],
      "–†–∏—Å –∑ –æ–≤–æ—á–∞–º–∏": ["–†–∏—Å", "–û–≤–æ—á–µ–≤–∞ —Å—É–º—ñ—à", "–°–æ—î–≤–∏–π —Å–æ—É—Å (–æ–ø—Ü.)"],
      "–ö—É—Å–∫—É—Å + –æ–≤–æ—á—ñ": ["–ö—É—Å–∫—É—Å", "–û–≤–æ—á–µ–≤–∞ —Å—É–º—ñ—à", "–û–ª–∏–≤–∫–æ–≤–∞ –æ–ª—ñ—è"],
      "–ô–æ–≥—É—Ä—Ç + —Ñ—Ä—É–∫—Ç–∏": ["–ô–æ–≥—É—Ä—Ç", "–§—Ä—É–∫—Ç–∏"]
    };

    const DAYS = [
      { key: "mon", label: "–ü–Ω" },
      { key: "tue", label: "–í—Ç" },
      { key: "wed", label: "–°—Ä" },
      { key: "thu", label: "–ß—Ç" },
      { key: "fri", label: "–ü—Ç" },
      { key: "sat", label: "–°–±" },
      { key: "sun", label: "–ù–¥" },
    ];

    const defaultPlan = {
      mon: { lunch: "–°–∞–ª–∞—Ç –∑ —Ç—É–Ω—Ü–µ–º", dinner: "–ü–∞—Å—Ç–∞ –∑ –æ–≤–æ—á–∞–º–∏" },
      tue: { lunch: "–ì—Ä–µ—á–∫–∞ + –∫—É—Ä–∫–∞", dinner: "–û–≤–æ—á–µ–≤–∏–π —Å—É–ø" },
      wed: { lunch: "–û–º–ª–µ—Ç –∑ —Å–∏—Ä–æ–º", dinner: "–†–∏—Å –∑ –æ–≤–æ—á–∞–º–∏" },
      thu: { lunch: "–ô–æ–≥—É—Ä—Ç + —Ñ—Ä—É–∫—Ç–∏", dinner: "–ó–∞–ø–µ—á–µ–Ω–∞ —Ä–∏–±–∞" },
      fri: { lunch: "–°–∞–ª–∞—Ç –∑ —Ç—É–Ω—Ü–µ–º", dinner: "–ß–∏–ª—ñ –∑ –∫–≤–∞—Å–æ–ª–µ—é" },
      sat: { lunch: "–°–∏—Ä–Ω–∏–∫–∏", dinner: "–ö—É—Å–∫—É—Å + –æ–≤–æ—á—ñ" },
      sun: { lunch: "–°–º—É–∑—ñ –±–æ—É–ª", dinner: "–ü–∞—Å—Ç–∞ –∑ –æ–≤–æ—á–∞–º–∏" }
    };

    const LS = { plan: "mpb_plan_final", have: "mpb_have_final" };

    function loadPlan(){
      try { return JSON.parse(localStorage.getItem(LS.plan)) || defaultPlan; }
      catch { return defaultPlan; }
    }
    function savePlan(plan){ localStorage.setItem(LS.plan, JSON.stringify(plan)); }

    function normalizeKey(s){
      return s.toLowerCase().replace(/\s+/g, "_").replace(/[^\w–∞-—è—ñ—ó—î“ë_-]/gi, "");
    }

    function mealOptionsHTML(selected){
      const opts = Object.keys(MEALS)
        .sort((a,b)=>a.localeCompare(b,"uk"))
        .map(name => `<option value="${name}" ${name===selected ? "selected" : ""}>${name}</option>`)
        .join("");
      return `<option value="">‚Äî –æ–±—Ä–∞—Ç–∏ ‚Äî</option>${opts}`;
    }

    function renderPlanner(){
      const grid = document.getElementById("plannerGrid");
      if (!grid) return;

      const plan = loadPlan();
      grid.innerHTML = "";

      DAYS.forEach(d => {
        const row = document.createEleme
