<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MealPrep Buddy ‚Äî –ü–ª–∞–Ω —Ç–∏–∂–Ω—è</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<header class="site-header">
  <div class="container header-row">
    <a class="brand" href="./" aria-label="–ì–æ–ª–æ–≤–Ω–∞">üç≤ MealPrep Buddy</a>
    <nav class="nav" aria-label="–ù–∞–≤—ñ–≥–∞—Ü—ñ—è">
      <a href="./">–ì–æ–ª–æ–≤–Ω–∞</a>
      <a href="planner.html" aria-current="page">–ü–ª–∞–Ω —Ç–∏–∂–Ω—è</a>
      <a href="shopping.html">–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫</a>
    </nav>
  </div>
</header>

<main>
  <section class="section">
    <div class="container">
      <h2>–ü–ª–∞–Ω —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å</h2>
      <p class="muted">–û–±–µ—Ä–∏ —Å—Ç—Ä–∞–≤–∏ –Ω–∞ –∫–æ–∂–µ–Ω –¥–µ–Ω—å. –ó–º—ñ–Ω–∏ –∑–±–µ—Ä–µ–∂—É—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.</p>

      <div class="card">
        <div id="plannerGrid"></div>
      </div>

      <div style="margin-top:16px; display:flex; gap:10px; flex-wrap:wrap;">
        <a class="btn" href="shopping.html">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –ø–æ–∫—É–ø–æ–∫</a>
        <button class="btn" id="resetBtn" type="button">–°–∫–∏–Ω—É—Ç–∏ –ø–ª–∞–Ω</button>
      </div>
    </div>
  </section>
</main>

<script>
  // ES5 + robust storage (prevents blank page from JSON.parse crashes)
  var LS_PLAN = "mpb_plan";

  var MEALS = {
    "–°–∞–ª–∞—Ç –∑ —Ç—É–Ω—Ü–µ–º": ["–¢—É–Ω–µ—Ü—å", "–õ–∏—Å—Ç—è —Å–∞–ª–∞—Ç—É", "–û–≥—ñ—Ä–æ–∫", "–ü–æ–º—ñ–¥–æ—Ä–∏", "–û–ª–∏–≤–∫–æ–≤–∞ –æ–ª—ñ—è"],
    "–ü–∞—Å—Ç–∞ –∑ –æ–≤–æ—á–∞–º–∏": ["–ü–∞—Å—Ç–∞", "–ë–æ–ª–≥–∞—Ä—Å—å–∫–∏–π –ø–µ—Ä–µ—Ü—å", "–¶–∏–±—É–ª—è", "–ß–∞—Å–Ω–∏–∫", "–¢–æ–º–∞—Ç–Ω–∏–π —Å–æ—É—Å"],
    "–ì—Ä–µ—á–∫–∞ + –∫—É—Ä–∫–∞": ["–ì—Ä–µ—á–∫–∞", "–ö—É—Ä—è—á–µ —Ñ—ñ–ª–µ", "–°–ø–µ—Ü—ñ—ó"],
    "–û–≤–æ—á–µ–≤–∏–π —Å—É–ø": ["–ö–∞—Ä—Ç–æ–ø–ª—è", "–ú–æ—Ä–∫–≤–∞", "–¶–∏–±—É–ª—è", "–õ–∞–≤—Ä–æ–≤–∏–π –ª–∏—Å—Ç"],
    "–û–º–ª–µ—Ç –∑ —Å–∏—Ä–æ–º": ["–Ø–π—Ü—è", "–¢–≤–µ—Ä–¥–∏–π —Å–∏—Ä", "–ó–µ–ª–µ–Ω—å"],
    "–ó–∞–ø–µ—á–µ–Ω–∞ —Ä–∏–±–∞": ["–†–∏–±–∞", "–õ–∏–º–æ–Ω", "–°—ñ–ª—å", "–ü–µ—Ä–µ—Ü—å"],
    "–ß–∏–ª—ñ –∑ –∫–≤–∞—Å–æ–ª–µ—é": ["–ö–≤–∞—Å–æ–ª—è", "–¢–æ–º–∞—Ç–Ω–∏–π —Å–æ—É—Å", "–¶–∏–±—É–ª—è", "–°–ø–µ—Ü—ñ—ó"],
    "–°–∏—Ä–Ω–∏–∫–∏": ["–¢–≤–æ—Ä–æ–≥", "–Ø–π—Ü—è", "–ë–æ—Ä–æ—à–Ω–æ", "–¶—É–∫–æ—Ä"],
    "–°–º—É–∑—ñ –±–æ—É–ª": ["–ë–∞–Ω–∞–Ω", "–Ø–≥–æ–¥–∏", "–ô–æ–≥—É—Ä—Ç", "–í—ñ–≤—Å—è–Ω–∫–∞"],
    "–†–∏—Å –∑ –æ–≤–æ—á–∞–º–∏": ["–†–∏—Å", "–û–≤–æ—á–µ–≤–∞ —Å—É–º—ñ—à", "–°–æ—î–≤–∏–π —Å–æ—É—Å (–æ–ø—Ü.)"],
    "–ö—É—Å–∫—É—Å + –æ–≤–æ—á—ñ": ["–ö—É—Å–∫—É—Å", "–û–≤–æ—á–µ–≤–∞ —Å—É–º—ñ—à", "–û–ª–∏–≤–∫–æ–≤–∞ –æ–ª—ñ—è"],
    "–ô–æ–≥—É—Ä—Ç + —Ñ—Ä—É–∫—Ç–∏": ["–ô–æ–≥—É—Ä—Ç", "–§—Ä—É–∫—Ç–∏"]
  };

  var DAYS = [
    {k:"mon", l:"–ü–Ω"},
    {k:"tue", l:"–í—Ç"},
    {k:"wed", l:"–°—Ä"},
    {k:"thu", l:"–ß—Ç"},
    {k:"fri", l:"–ü—Ç"},
    {k:"sat", l:"–°–±"},
    {k:"sun", l:"–ù–¥"}
  ];

  var defaultPlan = {
    mon:{lunch:"–°–∞–ª–∞—Ç –∑ —Ç—É–Ω—Ü–µ–º", dinner:"–ü–∞—Å—Ç–∞ –∑ –æ–≤–æ—á–∞–º–∏"},
    tue:{lunch:"–ì—Ä–µ—á–∫–∞ + –∫—É—Ä–∫–∞", dinner:"–û–≤–æ—á–µ–≤–∏–π —Å—É–ø"},
    wed:{lunch:"–û–º–ª–µ—Ç –∑ —Å–∏—Ä–æ–º", dinner:"–†–∏—Å –∑ –æ–≤–æ—á–∞–º–∏"},
    thu:{lunch:"–ô–æ–≥—É—Ä—Ç + —Ñ—Ä—É–∫—Ç–∏", dinner:"–ó–∞–ø–µ—á–µ–Ω–∞ —Ä–∏–±–∞"},
    fri:{lunch:"–°–∞–ª–∞—Ç –∑ —Ç—É–Ω—Ü–µ–º", dinner:"–ß–∏–ª—ñ –∑ –∫–≤–∞—Å–æ–ª–µ—é"},
    sat:{lunch:"–°–∏—Ä–Ω–∏–∫–∏", dinner:"–ö—É—Å–∫—É—Å + –æ–≤–æ—á—ñ"},
    sun:{lunch:"–°–º—É–∑—ñ –±–æ—É–ª", dinner:"–ü–∞—Å—Ç–∞ –∑ –æ–≤–æ—á–∞–º–∏"}
  };

  function safeParse(raw){
    try { return JSON.parse(raw); } catch(e) { return null; }
  }

  function loadPlan(){
    var raw = localStorage.getItem(LS_PLAN);
    if (!raw) return defaultPlan;

    var parsed = safeParse(raw);
    if (!parsed) {
      localStorage.removeItem(LS_PLAN);
      return defaultPlan;
    }
    return parsed;
  }

  function savePlan(p){
    try { localStorage.setItem(LS_PLAN, JSON.stringify(p)); } catch(e) {}
  }

  function esc(s){
    return String(s)
      .replace(/&/g,"&amp;")
      .replace(/</g,"&lt;")
      .replace(/>/g,"&gt;")
      .replace(/"/g,"&quot;")
      .replace(/'/g,"&#39;");
  }

  function mealNames(){
    var arr = [];
    for (var m in MEALS) if (MEALS.hasOwnProperty(m)) arr.push(m);
    arr.sort(function(a,b){ return a.localeCompare(b, "uk"); });
    return arr;
  }

  function optionsHTML(selected){
    var names = mealNames();
    var html = "<option value=''>‚Äî –æ–±—Ä–∞—Ç–∏ ‚Äî</option>";
    for (var i=0;i<names.length;i++){
      var name = names[i];
      html += "<option value='" + esc(name) + "'" + (name===selected ? " selected" : "") + ">" + name + "</option>";
    }
    return html;
  }

  function render(){
    var plan = loadPlan();
    var grid = document.getElementById("plannerGrid");
    if (!grid) return;

    grid.innerHTML = "";

    for (var i=0;i<DAYS.length;i++){
      var d = DAYS[i];
      var day = plan[d.k] || { lunch:"", dinner:"" };

      var row = document.createElement("div");
      row.className = "planner-row";

      row.innerHTML =
        "<div><strong>" + d.l + "</strong></div>" +
        "<div style='margin-top:8px'>" +
          "<span class='muted'>–û–±—ñ–¥:</span> " +
          "<select data-day='" + d.k + "' data-slot='lunch'>" + optionsHTML(day.lunch || "") + "</select> " +
          "<span class='muted' style='margin-left:10px'>–í–µ—á–µ—Ä—è:</span> " +
          "<select data-day='" + d.k + "' data-slot='dinner'>" + optionsHTML(day.dinner || "") + "</select>" +
        "</div>";

      grid.appendChild(row);
    }

    var selects = grid.getElementsByTagName("select");
    for (var s=0;s<selects.length;s++){
      selects[s].onchange = function(){
        var p = loadPlan();
        var dayKey = this.getAttribute("data-day");
        var slot = this.getAttribute("data-slot");
        if (!p[dayKey]) p[dayKey] = { lunch:"", dinner:"" };
        p[dayKey][slot] = this.value;
        savePlan(p);
      };
    }
  }

  var resetBtn = document.getElementById("resetBtn");
  if (resetBtn){
    resetBtn.onclick = function(){
      localStorage.removeItem(LS_PLAN);
      render();
    };
  }

  render();
</script>

<footer class="site-footer">
  <div class="container">
    –ö–æ–Ω—Ç–∞–∫—Ç–∏: <a href="mailto:contact@example.com">contact@example.com</a>
  </div>
</footer>

</body>
</html>
